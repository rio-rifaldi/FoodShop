"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.graphqlUploadKoa = void 0;
const processRequest_1 = require("./processRequest");
function graphqlUploadKoa(params = {}) {
    const { processRequest = processRequest_1.processRequest, ...processRequestOptions } = params;
    return async function graphqlUploadKoaMiddleware(ctx, next) {
        if (!ctx.request.is('multipart/form-data'))
            return next();
        const finished = new Promise((resolve) => ctx.req.on('end', resolve));
        try {
            ctx.request.body = await processRequest(ctx.req, ctx.res, processRequestOptions);
            await next();
        }
        finally {
            await finished;
        }
    };
}
exports.graphqlUploadKoa = graphqlUploadKoa;
//# sourceMappingURL=graphqlUploadKoa.js.map